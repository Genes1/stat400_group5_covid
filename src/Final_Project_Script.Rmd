---
title: "Final_Project_Script"
output: html_document
author: "STAT400 Group #5"
---

```{r open csvs }
library(dplyr)
# install.packages("ggplot2") if you are missing it
library(ggplot2)



# Created 4 dataframes from each of the CSV datasets. No need to have files 
# saved in specific location, due to the way the datasets were pulled.
# @Daniel not sure if pulling data from specific remote URL is good idea :v
# made path relative, do you agree?

#active_cases <- read.csv("https://raw.githubusercontent.com/Genes1/stat400_group5_covid/master/data/selected/active.csv")
#recovery_total <- read.csv("https://raw.githubusercontent.com/Genes1/stat400_group5_covid/master/data/selected/cumulative_recoved_total.csv")
#cumulative_recovery_rate <- read.csv("https://raw.githubusercontent.com/Genes1/stat400_group5_covid/master/data/selected/cumulative_recovery_rate.csv")
#recovery_proportion <- read.csv("https://raw.githubusercontent.com/Genes1/stat400_group5_covid/master/data/selected/daily_recovery_proportion.csv")


 transpose_and_rename <- function(df){
   
   # transpose the data, so that making visuals is easier
  df <- as.data.frame(t(df))
  
  # make the states the column names
  names(df) <- df %>% slice(1) %>% unlist()
  
  # slice off the first row, where the state names were
  df <- df %>% slice(-1)
  df$RI <- as.numeric(df$RI)
  df$MD <- as.numeric(df$MD)
  df$VA <- as.numeric(df$VA)
  df$DC <- as.numeric(df$DC)

  return(df)
}

active_cases <- read.csv("../data/selected/active.csv")
active_cases <- transpose_and_rename(active_cases)
#active_cases <- as.data.frame(t(active_cases))
#names(active_cases) <- active_cases %>% slice(1) %>% unlist()
#active_cases <- active_cases %>% slice(-1)

recovery_total <- read.csv("../data/selected/cumulative_recoved_total.csv")
recovery_total <- transpose_and_rename(recovery_total)

cumulative_recovery_rate <- read.csv("../data/selected/cumulative_recovery_rate.csv")
cumulative_recovery_rate <- transpose_and_rename(cumulative_recovery_rate)

recovery_proportion <- read.csv("../data/selected/daily_recovery_proportion.csv")
recovery_proportion <- transpose_and_rename(recovery_proportion)

```


``` {r check NA}

# Ensured no possibility of NA data points influencing further data 
# collection/manipulation.

active_cases <- active_cases[complete.cases(active_cases), ]
recovery_total <- recovery_total[complete.cases(recovery_total), ]
cumulative_recovery_rate <- cumulative_recovery_rate[complete.cases(cumulative_recovery_rate), ]
recovery_proportion <- recovery_proportion[complete.cases(recovery_proportion), ]


```


``` {r return/display dfs}

# Displayed all dataframes

active_cases
recovery_total
cumulative_recovery_rate
recovery_proportion

```

``` {r daily proportion plot}

r <- data.matrix(active_cases)


# cumulative recovery rate

ggplot(data=cumulative_recovery_rate, aes(x=rownames(cumulative_recovery_rate), y=RI, group=1)) +
  scale_y_continuous(limits = c(0, 1)) +
  geom_line(color="red") +
  ggtitle("Cumulative Recovery Rate") + 
  ylab("") + 
  xlab("") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_line(data=cumulative_recovery_rate, aes(x=rownames(cumulative_recovery_rate), y=VA, group=2), colour="#0000FF") +
  geom_line(data=cumulative_recovery_rate, aes(x=rownames(cumulative_recovery_rate), y=MD, group=3), colour="#00FF00") +
  geom_line(data=cumulative_recovery_rate, aes(x=rownames(cumulative_recovery_rate), y=DC, group=4), colour="#FF00FF")



# proportional recovery rate

ggplot(data=recovery_proportion, aes(x=rownames(recovery_proportion), y=RI, group=1)) +
  scale_y_continuous(limits = c(0, 0.1)) +
  geom_line(color="red") +
  ggtitle("Daily Recovery Proportion") + 
  ylab("") + 
  xlab("") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_line(data=recovery_proportion, aes(x=rownames(recovery_proportion), y=VA, group=2), colour="#0000FF") +
  geom_line(data=recovery_proportion, aes(x=rownames(recovery_proportion), y=MD, group=3), colour="#00FF00") +
  geom_line(data=recovery_proportion, aes(x=rownames(recovery_proportion), y=DC, group=4), colour="#FF00FF")





  
```










